---
import BaseBanner from '../components/BaseBanner.astro'
import BaseLink from '../components/BaseLink.astro'
import PostList from '../components/PostList.astro'
import ProjectList from '../components/ProjectList.astro'
import TitledContainer from '../components/TitledContainer.astro'
import BaseLayout from '../layouts/BaseLayout.astro'

const projects = (await Astro.glob('./projects/*.{md,mdx}'))
  .filter(
    (project) =>
      project.frontmatter.featured && !project.frontmatter.draft
  )
  .sort(
    (b, a) =>
      new Date(a.frontmatter.pubDate).valueOf() -
      new Date(b.frontmatter.pubDate).valueOf()
  )

const posts = (await Astro.glob('./blog/*.{md,mdx}'))
  .filter(
    (post) =>
      post.frontmatter.featured && !post.frontmatter.draft
  )
  .sort(
    (b, a) =>
      new Date(b.frontmatter.pubDate).valueOf() -
      new Date(a.frontmatter.pubDate).valueOf()
  )
---

<BaseLayout>
  <TitledContainer title="About">
    <BaseBanner />
  </TitledContainer>
  <TitledContainer title="Projects">
    <ProjectList projects={projects} />
    <BaseLink to="/projects">Show all →</BaseLink>
  </TitledContainer>
  <TitledContainer title="Posts">
    <PostList posts={posts} />
    <BaseLink to="/projects">Read all →</BaseLink>
  </TitledContainer>
</BaseLayout>
