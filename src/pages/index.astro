---
import BaseBanner from "../components/BaseBanner.astro";
import BaseLink from "../components/BaseLink.astro";
import PostList from "../components/PostList.astro";
import ProjectList from "../components/ProjectList.astro";
import TitledContainer from "../components/TitledContainer.astro";
import BaseLayout from "../layouts/BaseLayout.astro";

// Projects

const projects = (await Astro.glob("./projects/*.{md,mdx}"))
  .filter(
    (project) =>
      project.frontmatter.featured && !project.frontmatter.draft
  )
  .sort(
    (b, a) =>
      new Date(a.frontmatter.pubDate).valueOf() -
      new Date(b.frontmatter.pubDate).valueOf()
  );

// Posts

const posts = (await Astro.glob("./blog/*.{md,mdx}"))
  .filter(
    (post) =>
      post.frontmatter.featured && !post.frontmatter.draft
  )
  .sort(
    (a, b) =>
      new Date(b.frontmatter.pubDate).valueOf() -
      new Date(a.frontmatter.pubDate).valueOf()
  );

// Books
// Status types

type BookStatusType = "In progress" | "Published";

type Book = {
  id: string;
  title: string;
  url: string;
  text: string;
  status: BookStatusType;
};

const books: Array<Book> = [
  {
    id: "1",
    title: "Who is Product Manager?",
    url: "books/who-is-product-manager",
    status: "In progress",
    text: "typeing",
  },
];
---

<BaseLayout>
  <TitledContainer>
    <BaseBanner />
  </TitledContainer>
  <TitledContainer title="Books">
    <PostList posts={books} />
  </TitledContainer>
  <TitledContainer title="Projects">
    <ProjectList projects={projects} />
    <BaseLink to="/projects">show all &rarr;</BaseLink>
  </TitledContainer>
  <TitledContainer title="Posts">
    <PostList posts={posts} />
    <BaseLink to="/projects">read all &rarr;</BaseLink>
  </TitledContainer>
</BaseLayout>
