---
import BaseBanner from "../components/server/BaseBanner.astro";
import PostList from "../components/server/PostList.astro";
import ProjectList from "../components/server/ProjectList.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import TitledContainer from "../components/server/TitledContainer.astro";

const projects = (await Astro.glob("./projects/*.{md,mdx}"))
  .filter(
    (project) => project.frontmatter.featured && !project.frontmatter.draft
  )
  .sort(
    (b, a) =>
      new Date(a.frontmatter.pubDate).valueOf() -
      new Date(b.frontmatter.pubDate).valueOf()
  );

const articles = await Astro.glob("./articles/*.{md,mdx}");

const featuredPosts = articles
  .filter((post) => post.frontmatter.featured && !post.frontmatter.draft)
  .sort(
    (a, b) =>
      new Date(b.frontmatter.pubDate).valueOf() -
      new Date(a.frontmatter.pubDate).valueOf()
  );
---

<BaseLayout>
  <TitledContainer>
    <BaseBanner />
  </TitledContainer>
  <TitledContainer title="Projects">
    <ProjectList items={projects} />
  </TitledContainer>
  <TitledContainer title="Articles" text="2022">
    <PostList posts={featuredPosts} />
  </TitledContainer>
</BaseLayout>
